AJS.$("#download-ter-report-button").on("click", function() {
    var downloadvar = AJS.$("#api-ter-response").html(); // Capture full modal content
    var jiraIssueReffUrl = AJS.params.baseURL + "/browse/" + globalIssuekey;
    
    // Create a new window for displaying the full report
    var printWindow = window.open('', '_blank');
    printWindow.document.open();
    printWindow.document.write(`
        <html>
        <head>
            <title>Citi-Plugin Test Exit Report for ${globalIssuekey}</title>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    padding: 20px;
                }
                .content-container {
                    width: 100%;
                    max-width: 800px;
                    margin: auto;
                    border: 1px solid #A4ACAF;
                    padding: 15px;
                    overflow: visible; /* Ensure full visibility */
                }
                textarea {
                    width: 100%;
                    height: auto;
                    white-space: pre-wrap; /* Preserve text formatting */
                }
                .collapsible-section {
                    border: 1px solid #2558E3;
                    padding: 10px;
                    margin-top: 10px;
                    background-color: #F0F4F8;
                }
                .arrow {
                    color: #A4ACAF;
                }
            </style>
        </head>
        <body>
            <a href="${jiraIssueReffUrl}">View Issue</a>
            <br>
            <div class="content-container">
                ${downloadvar} <!-- Inject full modal content -->
            </div>
        </body>
        </html>
    `);
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    printWindow.close();
});